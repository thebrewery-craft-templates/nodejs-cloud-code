/*
 *** NOTE: PLEASE DO NOT EDIT THIS FILE ***
 *
 */
const args = process.argv || [];
const test = args.some((arg) => arg.includes("jasmine"));

// Import the library
import {
  init,
  recreateSchedule,
  destroySchedule,
} from "@brewery/parse-job-scheduler";

if (!test) {
  // Initialize a Parse instance
  init({
    serverURL: process.env.SERVER_URL || "http://localhost:1337/parse",
    appId: process.env.APP_ID || "myAppId",
    masterKey: process.env.MASTER_KEY || "masterKey",
  });

  // Recreates all crons when the server is launched
  recreateSchedule();

  // Recreates schedule when a job schedule has changed
  Parse.Cloud.afterSave("_JobSchedule", async (request) => {
    recreateSchedule(request.object);
  });

  // Destroy schedule for removed job
  Parse.Cloud.afterDelete("_JobSchedule", async (request) => {
    destroySchedule(request.object);
  });
}
